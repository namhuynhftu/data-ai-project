version: 2

models:
  - name: mart_sales_metrics
    description: >
      **Sales Metrics Mart** - Aggregated business metrics for executive reporting.
      
      **Business Purpose:** Track overall business health, revenue trends, and operational efficiency.
      
      **Grain:** One row per month, customer state, seller state, and product category combination.
      
      **Key Metrics:**
      - GMV (Gross Merchandise Value)
      - Revenue (GMV + Freight)
      - On-time delivery rate
      - Average approval and delivery times
      - Customer satisfaction scores
    meta:
      owner: "Analytics Team"
      layer: "mart_metrics"
      criticality: "high"
    columns:
      - name: order_month
        description: "Month of order placement"
        data_tests:
          - not_null
      - name: total_orders
        description: "Count of unique orders in the period"
      - name: gross_merchandise_value
        description: "Total product value (excluding freight)"
      - name: total_revenue
        description: "Total revenue including freight"
      - name: on_time_delivery_rate
        description: "Percentage of orders delivered on or before estimated date"
      - name: avg_review_score
        description: "Average customer review score (1-5)"

  - name: mart_customer_metrics
    description: >
      **Customer Metrics Mart** - Customer lifetime value, segmentation, and behavior analysis.
      
      **Business Purpose:** Enable customer analytics, retention strategies, and personalization.
      
      **Grain:** One row per unique customer.
      
      **Key Metrics:**
      - Customer Lifetime Value (CLV)
      - RFM Segmentation (Recency, Frequency, Monetary)
      - Customer tenure and engagement
      - Average order value
    meta:
      owner: "Analytics Team"
      layer: "mart_metrics"
      criticality: "high"
    columns:
      - name: customer_key
        description: "Surrogate key for customer dimension"
        data_tests:
          - unique
          - not_null
      - name: customer_lifetime_value
        description: "Total revenue generated by customer over their lifetime"
        data_tests:
          - not_null
      - name: customer_segment
        description: "Customer segmentation based on CLV, orders, and recency"
      - name: recency_days
        description: "Days since customer's last order"
      - name: frequency
        description: "Total number of orders placed by customer"
      - name: monetary_value
        description: "Total spending by customer (same as CLV)"

  - name: mart_product_metrics
    description: >
      **Product Metrics Mart** - Product performance, ratings, and category insights.
      
      **Business Purpose:** Product portfolio management, merchandising decisions, and inventory optimization.
      
      **Grain:** One row per unique product.
      
      **Key Metrics:**
      - Product sales volume and revenue
      - Customer ratings and satisfaction
      - Product lifecycle stage
      - Sales tier classification
    meta:
      owner: "Analytics Team"
      layer: "mart_metrics"
      criticality: "high"
    columns:
      - name: product_key
        description: "Surrogate key for product dimension"
        data_tests:
          - unique
          - not_null
      - name: total_units_sold
        description: "Total quantity of product sold"
      - name: total_sales_revenue
        description: "Total revenue from product sales"
      - name: avg_product_rating
        description: "Average customer rating for this product"
      - name: sales_tier
        description: "Classification based on sales volume (Top Seller, Popular, Moderate, Low Volume)"
      - name: quality_tier
        description: "Classification based on customer ratings (Excellent, Good, Average, Below Average)"
